<!DOCTYPE html>
<html>

<head>
    <script src="https://sdk.amazonaws.com/js/aws-sdk-3.188.0.min.js"></script>
    <script type="module">
        import { S3Client, PutObjectCommand } from "https://sdk.amazonaws.com/js/aws-sdk-3.188.0.mjs";
        window.S3Client = S3Client;
        window.PutObjectCommand = PutObjectCommand;
    </script>
</head>

<body>
    <input type="text" id="accessKeyId" placeholder="Access Key ID">
    <input type="password" id="secretAccessKey" placeholder="Secret Access Key">
    <input type="file" id="fileInput">
    <button onclick="uploadFile()">Upload</button>
    <div id="urlDisplay"></div>

    <script>
        async function uploadFile() {
            const accessKeyId = document.getElementById('accessKeyId').value;
            const secretAccessKey = document.getElementById('secretAccessKey').value;
            const file = document.getElementById('fileInput').files[0];

            const client = new S3Client({
                region: 'eu-west-3', // replace with your region
                credentials: {
                    accessKeyId: accessKeyId,
                    secretAccessKey: secretAccessKey
                }
            });

            const params = {
                Bucket: 'datatalkstatic', // replace with your bucket name
                Key: file.name,
                Body: file,
                ACL: 'public-read'
            };

            try {
                const command = new PutObjectCommand(params);
                const response = await client.send(command);
                console.log("Upload Success", response);
                const publicUrl = `https://${params.Bucket}.s3.amazonaws.com/${encodeURIComponent(params.Key)}`;
                console.log("Public URL:", publicUrl);
                document.getElementById('urlDisplay').textContent = "Public URL: " + publicUrl;
            } catch (err) {
                console.log("Error", err);
                document.getElementById('urlDisplay').textContent = "Error uploading file: " + err.message;
            }
        }
    </script>
</body>

</html>
